pip install flask
from flask import Flask, request, jsonify, render_template_string
from datetime import datetime

app = Flask(__name__)

# List untuk menyimpan pesan chat
messages = []

# Halaman HTML (biar simpel, pakai template string)
HTML_PAGE = """
<!DOCTYPE html>
<html>

<head>
    <title>Chat Web</title>
    <style>
        body {
            font-family: Arial;
        }

        .timestamp {
            color: gray;
            font-size: 0.9em;
        }

        .post {
            color: green;
        }

        .get {
            color: blue;
        }
    </style>
</head>

<body>
    <h1>Chat Web</h1>
    <div id="chat-box" style="border:1px solid #ccc; padding:10px; height:200px; overflow-y:scroll;"></div>
    <input type="text" id="message" placeholder="Ketik pesan...">
    <button onclick="sendPost()">Kirim</button>
    <button onclick="loadMessages()">Refresh</button>

    <script>
        function sendPost() {
            let msg = document.getElementById('message').value;
            fetch('/chat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message: msg })
            })
                .then(res => res.json())
                .then(data => {
                    loadMessages();
                    document.getElementById('message').value = '';
                });
        }

        function loadMessages() {
            fetch('/chat')
                .then(res => res.json())
                .then(data => {
                    let chatBox = document.getElementById('chat-box');
                    chatBox.innerHTML = '';
                    data.messages.forEach(msg => {
                        chatBox.innerHTML += `<div><span class="timestamp">[${msg.timestamp}]</span> <span class="${msg.type}">${msg.type.toUpperCase()}:</span> ${msg.text}</div>`;
                    });
                });
        }

        // Auto-load saat halaman pertama kali
        loadMessages();
    </script>
</body>

</html>
"""

@app.route('/')
def index():
return render_template_string(HTML_PAGE)

@app.route('/chat', methods=['GET', 'POST'])
def chat():
if request.method == 'POST':
data = request.json
text = data.get('message', '')
timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
messages.append({
'type': 'post',
'text': text,
'timestamp': timestamp
})
return jsonify({'status': 'ok'})
else: # GET
return jsonify({'messages': messages})

if __name__ == '__main__':
app.run(debug=True)